<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>درس چرخه آب - پایه سوم</title>
    <style>
        /* تنظیمات عمومی */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e0f7fa 0%, #bbdefb 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 100, 150, 0.2);
            overflow: hidden;
            padding-bottom: 30px;
        }
        
        /* هدر */
        header {
            background: linear-gradient(90deg, #0288d1 0%, #26c6da 100%);
            color: white;
            padding: 25px 20px;
            text-align: center;
            border-bottom: 5px solid #ff9800;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* محتوای اصلی */
        .main-content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* انیمیشن چرخه آب */
        .animation-container {
            width: 100%;
            max-width: 700px;
            height: 300px;
            background-color: #e1f5fe;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border: 3px solid #0288d1;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .animation-element {
            position: absolute;
            transition: all 2s ease;
        }
        
        .sun {
            width: 60px;
            height: 60px;
            background-color: #ffeb3b;
            border-radius: 50%;
            top: 20px;
            left: 40px;
            box-shadow: 0 0 20px #ff9800;
            animation: sunGlow 3s infinite alternate;
        }
        
        @keyframes sunGlow {
            from { box-shadow: 0 0 20px #ff9800; }
            to { box-shadow: 0 0 30px #ff9800, 0 0 40px #ff9800; }
        }
        
        .sea {
            width: 100%;
            height: 80px;
            background-color: #0288d1;
            bottom: 0;
            left: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .water-wave {
            position: absolute;
            width: 100%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.3);
            bottom: 80px;
            animation: wave 4s infinite linear;
        }
        
        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-30px); }
        }
        
        .cloud {
            width: 120px;
            height: 60px;
            background-color: white;
            border-radius: 50%;
            top: 100px;
            opacity: 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .cloud:before, .cloud:after {
            content: '';
            position: absolute;
            background-color: white;
            border-radius: 50%;
        }
        
        .cloud:before {
            width: 50px;
            height: 50px;
            top: -20px;
            left: 20px;
        }
        
        .cloud:after {
            width: 70px;
            height: 70px;
            top: -25px;
            right: 20px;
        }
        
        .rain-drop {
            width: 4px;
            height: 15px;
            background-color: #0288d1;
            border-radius: 0 0 2px 2px;
            position: absolute;
            opacity: 0;
        }
        
        .mountain {
            width: 150px;
            height: 100px;
            background-color: #8bc34a;
            position: absolute;
            bottom: 80px;
            right: 50px;
            clip-path: polygon(50% 0, 100% 100%, 0 100%);
            z-index: 1;
        }
        
        /* کنترل مراحل */
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
        }
        
        .stage-btn {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 0 #f57c00;
            font-weight: bold;
            min-width: 160px;
        }
        
        .stage-btn:hover {
            background-color: #ffb74d;
            transform: translateY(-3px);
        }
        
        .stage-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #f57c00;
        }
        
        .stage-btn.active {
            background-color: #4caf50;
            box-shadow: 0 5px 0 #388e3c;
        }
        
        .reset-btn {
            background-color: #f44336;
            box-shadow: 0 5px 0 #d32f2f;
            margin-top: 10px;
        }
        
        .reset-btn:hover {
            background-color: #ef5350;
        }
        
        /* توضیحات مراحل */
        .stage-description {
            background-color: #e8f5e9;
            border-right: 5px solid #4caf50;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.2rem;
            line-height: 1.8;
        }
        
        /* کوییز */
        .quiz-container {
            background-color: #f5f5f5;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            width: 100%;
            max-width: 700px;
            border: 2px dashed #0288d1;
            display: none;
        }
        
        .quiz-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            color: #0288d1;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.8rem;
        }
        
        .question {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .question h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        @media (min-width: 600px) {
            .options {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .option-btn {
            background-color: #e3f2fd;
            border: 2px solid #bbdefb;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
            font-size: 1rem;
        }
        
        .option-btn:hover {
            background-color: #bbdefb;
            transform: translateY(-2px);
        }
        
        .option-btn.correct {
            background-color: #c8e6c9;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .option-btn.wrong {
            background-color: #ffcdd2;
            border-color: #f44336;
            color: #c62828;
        }
        
        .feedback {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            min-height: 30px;
        }
        
        .correct-feedback {
            color: #4caf50;
        }
        
        .wrong-feedback {
            color: #f44336;
        }
        
        /* نمایش نتایج */
        .results {
            text-align: center;
            padding: 25px;
            background-color: #e8f5e9;
            border-radius: 15px;
            margin-top: 30px;
            width: 100%;
            max-width: 700px;
            display: none;
        }
        
        .results.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .score {
            font-size: 2.5rem;
            color: #0288d1;
            margin: 15px 0;
        }
        
        .stars {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
        }
        
        .star {
            font-size: 3rem;
            color: #ddd;
            transition: all 0.3s ease;
        }
        
        .star.active {
            color: #ffeb3b;
            text-shadow: 0 0 10px rgba(255, 235, 59, 0.7);
        }
        
        .restart-btn {
            background-color: #0288d1;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 0 #01579b;
            font-weight: bold;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            background-color: #03a9f4;
            transform: translateY(-3px);
        }
        
        /* فوتر */
        footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* سازگاری با موبایل */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .animation-container {
                height: 250px;
            }
            
            .stage-btn {
                min-width: 140px;
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .controls {
                gap: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                border-radius: 15px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .stage-btn {
                min-width: 100%;
            }
            
            .animation-container {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>درس چرخه آب</h1>
            <div class="subtitle">آموزش تعاملی برای دانش‌آموزان پایه سوم</div>
        </header>
        
        <div class="main-content">
            <div class="animation-container" id="animationContainer">
                <!-- عناصر انیمیشن توسط JavaScript اضافه می‌شوند -->
            </div>
            
            <div class="stage-description" id="stageDescription">
                برای شروع درس، روی دکمه‌های زیر کلیک کنید تا مراحل چرخه آب را ببینید.
            </div>
            
            <div class="controls">
                <button class="stage-btn" data-stage="1">۱. تبخیر آب</button>
                <button class="stage-btn" data-stage="2">۲. تشکیل ابر</button>
                <button class="stage-btn" data-stage="3">۳. بارش باران</button>
                <button class="stage-btn" data-stage="4">۴. جمع‌آوری آب</button>
                <button class="stage-btn reset-btn" id="resetBtn">شروع دوباره</button>
            </div>
            
            <button class="stage-btn" id="startQuizBtn" style="background-color: #9c27b0; box-shadow: 0 5px 0 #7b1fa2; margin-top: 10px;">
                شروع کوییز
            </button>
            
            <div class="quiz-container" id="quizContainer">
                <h2>کوییز چرخه آب</h2>
                <div id="questionsContainer">
                    <!-- سوالات توسط JavaScript اضافه می‌شوند -->
                </div>
                <div class="feedback" id="feedback"></div>
                <button class="stage-btn" id="submitQuizBtn" style="display: none; margin: 0 auto;">مشاهده نتیجه</button>
            </div>
            
            <div class="results" id="resultsContainer">
                <h2>نتیجه کوییز</h2>
                <div class="score" id="scoreText">امتیاز شما: ۰ از ۵</div>
                <div class="stars" id="starsContainer">
                    <!-- ستاره‌ها توسط JavaScript اضافه می‌شوند -->
                </div>
                <p id="resultMessage"></p>
                <button class="restart-btn" id="restartBtn">بازیابی درس</button>
            </div>
        </div>
        
        <footer>
            طراحی شده برای آموزش تعاملی دانش‌آموزان پایه سوم
        </footer>
    </div>

    <script>
        // تعریف متغیرهای اصلی
        let currentStage = 0;
        let quizAnswers = [];
        let quizScore = 0;
        let audioContext;
        let currentQuestion = 0;
        
        // داده‌های مراحل چرخه آب
        const stages = [
            {
                title: "تبخیر آب",
                description: "خورشید آب دریاها، رودخانه‌ها و دریاچه‌ها را گرم می‌کند و آن را به بخار آب تبدیل می‌کند. این بخار آب سبک است و به سمت آسمان بالا می‌رود.",
                animation: "evaporation"
            },
            {
                title: "تشکیل ابر",
                description: "بخار آب در ارتفاعات بالا با هوای سرد برخورد می‌کند و دوباره به قطره‌های ریز آب تبدیل می‌شود. این قطره‌ها به هم می‌پیوندند و ابر تشکیل می‌دهند.",
                animation: "cloudFormation"
            },
            {
                title: "بارش باران",
                description: "وقتی قطره‌های آب درون ابر بزرگ و سنگین می‌شوند، نمی‌توانند در هوا بمانند و به شکل باران، برف یا تگرگ به زمین می‌بارند.",
                animation: "precipitation"
            },
            {
                title: "جمع‌آوری آب",
                description: "آب باران به زمین می‌رسد. مقداری از آن جذب زمین می‌شود و به آب‌های زیرزمینی تبدیل می‌شود و مقداری هم به دریاها و رودخانه‌ها بازمی‌گردد.",
                animation: "collection"
            }
        ];
        
        // داده‌های سوالات کوییز
        const quizQuestions = [
            {
                question: "چرخه آب با کدام مرحله شروع می‌شود؟",
                options: [
                    "تشکیل ابر",
                    "تبخیر آب",
                    "بارش باران",
                    "جمع‌آوری آب"
                ],
                correct: 1
            },
            {
                question: "چه چیزی باعث تبخیر آب می‌شود؟",
                options: [
                    "باد",
                    "خورشید",
                    "ابر",
                    "کوه"
                ],
                correct: 1
            },
            {
                question: "ابرها چگونه تشکیل می‌شوند؟",
                options: [
                    "وقتی آب باران به زمین می‌خورد",
                    "وقتی بخار آب سرد می‌شود",
                    "وقتی خورشید می‌درخشد",
                    "وقتی باد می‌وزد"
                ],
                correct: 1
            },
            {
                question: "وقتی قطره‌های آب در ابر سنگین می‌شوند چه اتفاقی می‌افتد؟",
                options: [
                    "تبخیر می‌شوند",
                    "به شکل باران می‌بارند",
                    "ناپدید می‌شوند",
                    "بیشتر بالا می‌روند"
                ],
                correct: 1
            },
            {
                question: "آب باران پس از بارش چه می‌شود؟",
                options: [
                    "همه آن تبخیر می‌شود",
                    "به دریاها و رودخانه‌ها بازمی‌گردد",
                    "برای همیشه در زمین باقی می‌ماند",
                    "تبدیل به ابر می‌شود"
                ],
                correct: 1
            }
        ];
        
        // پیام‌های نتیجه بر اساس امتیاز
        const resultMessages = [
            "نگران نباش! دوباره درس را مرور کن و سپس کوییز را دوباره امتحان کن.",
            "باید بیشتر تمرین کنی. دوباره مراحل چرخه آب را ببین.",
            "خوب بود! اما می‌تونی بهتر هم یاد بگیری.",
            "آفرین! خیلی خوب یاد گرفتی.",
            "عالی! تو به تمام سوالات درست پاسخ دادی. آفرین!"
        ];
        
        // تابع برای ایجاد صداهای تشویقی
        function playBeepSound(type) {
            // اگر audioContext هنوز ساخته نشده، آن را ایجاد کن
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'correct') {
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(1000, audioContext.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            } else if (type === 'wrong') {
                oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'complete') {
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }
        
        // تابع برای ایجاد عناصر انیمیشن
        function createAnimationElements() {
            const container = document.getElementById('animationContainer');
            
            // خورشید
            const sun = document.createElement('div');
            sun.className = 'animation-element sun';
            sun.id = 'sun';
            container.appendChild(sun);
            
            // دریا
            const sea = document.createElement('div');
            sea.className = 'animation-element sea';
            sea.id = 'sea';
            container.appendChild(sea);
            
            // موج آب
            const waterWave = document.createElement('div');
            waterWave.className = 'animation-element water-wave';
            waterWave.id = 'waterWave';
            container.appendChild(waterWave);
            
            // ابر
            const cloud = document.createElement('div');
            cloud.className = 'animation-element cloud';
            cloud.id = 'cloud';
            container.appendChild(cloud);
            
            // کوه
            const mountain = document.createElement('div');
            mountain.className = 'animation-element mountain';
            mountain.id = 'mountain';
            container.appendChild(mountain);
            
            // قطره‌های باران (توسط JavaScript در هنگام نیاز ایجاد می‌شوند)
        }
        
        // تابع برای نمایش مرحله مورد نظر
        function showStage(stageNumber) {
            // به روزرسانی مرحله فعلی
            currentStage = stageNumber;
            
            // به روزرسانی دکمه‌های فعال
            document.querySelectorAll('.stage-btn[data-stage]').forEach(btn => {
                const btnStage = parseInt(btn.getAttribute('data-stage'));
                if (btnStage <= stageNumber) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // به روزرسانی توضیحات
            const stage = stages[stageNumber - 1];
            document.getElementById('stageDescription').textContent = stage.description;
            
            // اجرای انیمیشن مربوطه
            runAnimation(stage.animation);
        }
        
        // تابع برای اجرای انیمیشن‌ها
        function runAnimation(animationType) {
            // دریافت عناصر انیمیشن
            const sun = document.getElementById('sun');
            const cloud = document.getElementById('cloud');
            const sea = document.getElementById('sea');
            const waterWave = document.getElementById('waterWave');
            
            // پاک کردن انیمیشن‌های قبلی
            document.querySelectorAll('.rain-drop').forEach(drop => drop.remove());
            cloud.style.opacity = '0';
            cloud.style.left = '50%';
            cloud.style.transform = 'translateX(-50%)';
            
            // اجرای انیمیشن بر اساس نوع
            switch(animationType) {
                case 'evaporation':
                    // خورشید درخشنده
                    sun.style.animation = 'sunGlow 3s infinite alternate';
                    
                    // موج‌های آب
                    waterWave.style.animation = 'wave 4s infinite linear';
                    
                    // نمایش بخار آب (نقاط کوچک بالا رونده)
                    for (let i = 0; i < 15; i++) {
                        setTimeout(() => {
                            const bubble = document.createElement('div');
                            bubble.className = 'animation-element';
                            bubble.style.width = '8px';
                            bubble.style.height = '8px';
                            bubble.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
                            bubble.style.borderRadius = '50%';
                            bubble.style.bottom = '80px';
                            bubble.style.left = `${30 + Math.random() * 80}%`;
                            bubble.style.transition = 'all 3s ease';
                            
                            document.getElementById('animationContainer').appendChild(bubble);
                            
                            // حرکت حباب به سمت بالا
                            setTimeout(() => {
                                bubble.style.bottom = '200px';
                                bubble.style.opacity = '0';
                            }, 100);
                            
                            // حذف حباب پس از انیمیشن
                            setTimeout(() => {
                                if (bubble.parentNode) {
                                    bubble.parentNode.removeChild(bubble);
                                }
                            }, 3100);
                        }, i * 200);
                    }
                    break;
                    
                case 'cloudFormation':
                    // خورشید ثابت
                    sun.style.animation = 'none';
                    
                    // نمایش ابر
                    cloud.style.opacity = '1';
                    cloud.style.transition = 'opacity 2s ease, left 4s ease';
                    
                    // حرکت ابر از سمت خورشید به مرکز
                    setTimeout(() => {
                        cloud.style.left = '50%';
                    }, 100);
                    break;
                    
                case 'precipitation':
                    // ابر در مرکز باقی می‌ماند
                    cloud.style.opacity = '1';
                    cloud.style.left = '50%';
                    
                    // ایجاد قطره‌های باران
                    for (let i = 0; i < 20; i++) {
                        setTimeout(() => {
                            const drop = document.createElement('div');
                            drop.className = 'rain-drop animation-element';
                            
                            // موقعیت تصادفی زیر ابر
                            const cloudLeft = 50; // ابر در 50% قرار دارد
                            const randomOffset = (Math.random() - 0.5) * 40; // انحراف تصادفی
                            drop.style.left = `${cloudLeft + randomOffset}%`;
                            drop.style.top = '160px';
                            drop.style.opacity = '1';
                            
                            document.getElementById('animationContainer').appendChild(drop);
                            
                            // افتادن قطره باران
                            setTimeout(() => {
                                drop.style.top = '220px';
                                drop.style.opacity = '0.5';
                            }, 100);
                            
                            // حذف قطره باران پس از رسیدن به زمین
                            setTimeout(() => {
                                if (drop.parentNode) {
                                    drop.parentNode.removeChild(drop);
                                }
                            }, 1500);
                        }, i * 200);
                    }
                    break;
                    
                case 'collection':
                    // ابر نیمه شفاف می‌شود
                    cloud.style.opacity = '0.5';
                    
                    // نمایش حرکت آب به سمت دریا
                    for (let i = 0; i < 10; i++) {
                        setTimeout(() => {
                            const stream = document.createElement('div');
                            stream.className = 'animation-element';
                            stream.style.width = '10px';
                            stream.style.height = '30px';
                            stream.style.backgroundColor = '#0288d1';
                            stream.style.borderRadius = '5px';
                            stream.style.top = '220px';
                            stream.style.left = `${60 + Math.random() * 20}%`;
                            stream.style.transition = 'all 2s ease';
                            
                            document.getElementById('animationContainer').appendChild(stream);
                            
                            // حرکت جریان آب به سمت دریا
                            setTimeout(() => {
                                stream.style.top = '280px';
                                stream.style.height = '5px';
                                stream.style.opacity = '0.7';
                            }, 100);
                            
                            // حذف جریان آب پس از رسیدن به دریا
                            setTimeout(() => {
                                if (stream.parentNode) {
                                    stream.parentNode.removeChild(stream);
                                }
                            }, 2100);
                        }, i * 300);
                    }
                    break;
            }
        }
        
        // تابع برای تنظیم مجدد انیمیشن و درس
        function resetLesson() {
            currentStage = 0;
            
            // بازنشانی دکمه‌ها
            document.querySelectorAll('.stage-btn[data-stage]').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // بازنشانی توضیحات
            document.getElementById('stageDescription').textContent = 
                "برای شروع درس، روی دکمه‌های زیر کلیک کنید تا مراحل چرخه آب را ببینید.";
            
            // مخفی کردن کوییز و نتایج
            document.getElementById('quizContainer').classList.remove('active');
            document.getElementById('resultsContainer').classList.remove('active');
            document.getElementById('startQuizBtn').style.display = 'block';
            
            // پاک کردن عناصر انیمیشن و ایجاد مجدد
            document.getElementById('animationContainer').innerHTML = '';
            createAnimationElements();
            
            // پخش صدای تشویقی
            playBeepSound('complete');
        }
        
        // تابع برای شروع کوییز
        function startQuiz() {
            // بازنشانی متغیرهای کوییز
            currentQuestion = 0;
            quizAnswers = [];
            quizScore = 0;
            
            // مخفی کردن دکمه شروع کوییز
            document.getElementById('startQuizBtn').style.display = 'none';
            
            // نمایش کوییز
            document.getElementById('quizContainer').classList.add('active');
            document.getElementById('resultsContainer').classList.remove('active');
            
            // بارگذاری اولین سوال
            loadQuestion(currentQuestion);
        }
        
        // تابع برای بارگذاری سوال
        function loadQuestion(questionIndex) {
            const questionData = quizQuestions[questionIndex];
            const questionsContainer = document.getElementById('questionsContainer');
            
            // پاک کردن سوال قبلی
            questionsContainer.innerHTML = '';
            
            // ایجاد سوال جدید
            const questionElement = document.createElement('div');
            questionElement.className = 'question';
            questionElement.innerHTML = `
                <h3>سوال ${questionIndex + 1}: ${questionData.question}</h3>
                <div class="options">
                    ${questionData.options.map((option, index) => `
                        <button class="option-btn" data-answer="${index}">${option}</button>
                    `).join('')}
                </div>
            `;
            
            questionsContainer.appendChild(questionElement);
            
            // مخفی کردن دکمه ارسال
            document.getElementById('submitQuizBtn').style.display = 'none';
            document.getElementById('feedback').textContent = '';
            
            // اضافه کردن رویداد به گزینه‌ها
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const selectedAnswer = parseInt(this.getAttribute('data-answer'));
                    checkAnswer(questionIndex, selectedAnswer);
                });
            });
        }
        
        // تابع برای بررسی پاسخ
        function checkAnswer(questionIndex, selectedAnswer) {
            const questionData = quizQuestions[questionIndex];
            const isCorrect = selectedAnswer === questionData.correct;
            
            // ذخیره پاسخ
            quizAnswers[questionIndex] = {
                selected: selectedAnswer,
                correct: isCorrect
            };
            
            // نمایش بازخورد
            const feedback = document.getElementById('feedback');
            const optionButtons = document.querySelectorAll('.option-btn');
            
            if (isCorrect) {
                feedback.textContent = "آفرین! پاسخ تو درست است.";
                feedback.className = 'feedback correct-feedback';
                playBeepSound('correct');
                quizScore++;
            } else {
                feedback.textContent = `پاسخ صحیح: ${questionData.options[questionData.correct]}`;
                feedback.className = 'feedback wrong-feedback';
                playBeepSound('wrong');
            }
            
            // رنگ‌آمیزی گزینه‌ها
            optionButtons.forEach((btn, index) => {
                if (index === questionData.correct) {
                    btn.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    btn.classList.add('wrong');
                }
                btn.disabled = true;
            });
            
            // نمایش دکمه بعدی یا ارسال
            if (questionIndex < quizQuestions.length - 1) {
                // ایجاد دکمه برای سوال بعدی
                const nextBtn = document.createElement('button');
                nextBtn.className = 'stage-btn';
                nextBtn.textContent = 'سوال بعدی';
                nextBtn.style.margin = '20px auto 0';
                nextBtn.style.display = 'block';
                
                nextBtn.addEventListener('click', function() {
                    loadQuestion(questionIndex + 1);
                });
                
                document.getElementById('quizContainer').appendChild(nextBtn);
            } else {
                // نمایش دکمه ارسال
                document.getElementById('submitQuizBtn').style.display = 'block';
            }
        }
        
        // تابع برای نمایش نتایج
        function showResults() {
            // مخفی کردن کوییز
            document.getElementById('quizContainer').classList.remove('active');
            
            // نمایش نتایج
            document.getElementById('resultsContainer').classList.add('active');
            
            // به روزرسانی امتیاز
            document.getElementById('scoreText').textContent = `امتیاز شما: ${quizScore} از ${quizQuestions.length}`;
            
            // به روزرسانی پیام نتیجه
            document.getElementById('resultMessage').textContent = resultMessages[quizScore];
            
            // نمایش ستاره‌ها
            const starsContainer = document.getElementById('starsContainer');
            starsContainer.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.textContent = '★';
                
                if (i < quizScore) {
                    star.classList.add('active');
                }
                
                starsContainer.appendChild(star);
            }
            
            // پخش صدای تشویقی برای نتیجه
            if (quizScore >= 3) {
                playBeepSound('complete');
            }
        }
        
        // تابع برای راه‌اندازی برنامه
        function initApp() {
            // ایجاد عناصر انیمیشن
            createAnimationElements();
            
            // اضافه کردن رویداد به دکمه‌های مراحل
            document.querySelectorAll('.stage-btn[data-stage]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const stageNumber = parseInt(this.getAttribute('data-stage'));
                    showStage(stageNumber);
                });
            });
            
            // اضافه کردن رویداد به دکمه شروع دوباره
            document.getElementById('resetBtn').addEventListener('click', resetLesson);
            
            // اضافه کردن رویداد به دکمه شروع کوییز
            document.getElementById('startQuizBtn').addEventListener('click', startQuiz);
            
            // اضافه کردن رویداد به دکمه ارسال کوییز
            document.getElementById('submitQuizBtn').addEventListener('click', showResults);
            
            // اضافه کردن رویداد به دکمه بازیابی درس
            document.getElementById('restartBtn').addEventListener('click', resetLesson);
            
            // نمایش مرحله اول به صورت پیش‌فرض
            showStage(1);
        }
        
        // راه‌اندازی برنامه پس از بارگذاری صفحه
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
